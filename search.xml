<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>使用Hexo搭建博客踩坑之旅</title>
    <url>/2021/03/10/hexo-blog-deploy/</url>
    <content><![CDATA[<p>很久之前就告诉自己一定要做一个自己的博客，在此之前做了一些调研，选择了Hexo+Github pages的方式，简单便捷，界面清新。<br><strong>安装的版本：</strong><br><strong>Hexo:5.4.0;</strong><br><strong>node:v15.11.0;</strong><br><strong>next:v7.8.0</strong></p>
<h1 id="1-一些必备的环境"><a href="#1-一些必备的环境" class="headerlink" title="1. 一些必备的环境"></a>1. 一些必备的环境</h1><span id="more"></span>
<h2 id="1-1-Git"><a href="#1-1-Git" class="headerlink" title="1.1 Git"></a>1.1 Git</h2><p>首先得有一个Github的账号，并在linux系统上装了Git。我们可以新建一个仓库，取名为username.github.io（username为你的Github账户名），作为博客的存储仓库，注意需为public仓库。</p>
<h2 id="1-2-安装Node-js"><a href="#1-2-安装Node-js" class="headerlink" title="1.2 安装Node.js"></a>1.2 安装Node.js</h2><p>Hexo是基于node.js的静态博客，因此需要安装node.js。看教程发现也有很多坑，选了正确的姿势之一：</p>
<p>NVM是Node Version Manager,是Node的版本管理工具。<br>参考<a href="https://github.com/nvm-sh/nvm">https://github.com/nvm-sh/nvm</a>，curl和wget的方式均可安装：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl -o- https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;nvm-sh&#x2F;nvm&#x2F;v0.37.2&#x2F;install.sh | bash</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget -qO- https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;nvm-sh&#x2F;nvm&#x2F;v0.37.2&#x2F;install.sh | bash</span><br></pre></td></tr></table></figure>
<p>安装完成后重启终端，就可以安装node了：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nvm install node # &quot;node&quot; is an alias for the latest version</span><br></pre></td></tr></table></figure>
<p>安装好后可以验证是否成功：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">node --version</span><br><span class="line">npm --version</span><br></pre></td></tr></table></figure>

<h1 id="2-安装Hexo，部署配置主题-amp-托管到Github-Pages"><a href="#2-安装Hexo，部署配置主题-amp-托管到Github-Pages" class="headerlink" title="2. 安装Hexo，部署配置主题&amp;托管到Github Pages"></a>2. 安装Hexo，部署配置主题&amp;托管到Github Pages</h1><h2 id="2-1-安装Hexo"><a href="#2-1-安装Hexo" class="headerlink" title="2.1 安装Hexo"></a>2.1 安装Hexo</h2><p>新建一个放博客站点的路径，然后安装Hexo：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
<p>接下来就可以初始化并创建博客了。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">hexo init blog #初始化博客站点</span><br><span class="line">cd blog</span><br><span class="line">npm install #安装依赖</span><br><span class="line"></span><br><span class="line">hexo g(generate)  #生成</span><br><span class="line">hexo s(server) #本地启动</span><br><span class="line">hexo s -p 8000 -o #自定义端口并自动打开浏览器访问localhost:8000</span><br><span class="line">hexo clean #清除缓存</span><br><span class="line">hexo d(deploy) #部署</span><br><span class="line">#组合命令：</span><br><span class="line">hexo d -g</span><br><span class="line">hexo s -g</span><br></pre></td></tr></table></figure>
<p>本地查看localhost:4000（默认端口），就可以看到博客的雏形了。</p>
<h2 id="2-2-托管到Github-Pages"><a href="#2-2-托管到Github-Pages" class="headerlink" title="2.2 托管到Github Pages"></a>2.2 托管到Github Pages</h2><p>修改博客项目的根路径配置文件_config.yml，找到deploy部分</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Deployment</span><br><span class="line">## Docs: https:&#x2F;&#x2F;hexo.io&#x2F;docs&#x2F;deployment.html</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https:&#x2F;&#x2F;github.com&#x2F;username&#x2F;username.github.io.git #https和ssh都行</span><br><span class="line">  branch: main</span><br></pre></td></tr></table></figure>
<p>安装hexo-deployer-git的部署器插件，通过该插件就能实现一键部署。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save </span><br></pre></td></tr></table></figure>
<p>接下来就可以通过以上的命令，hexo d -g一键部署到Github Pages上了。浏览器输入username.github.io就可以访问自己的博客主页了。</p>
<p>如果还想要绑定自己的域名，可以先购买自己的域名，然后我们可以利用阿里云控制台或者DNSPod来做一个域名解析服务。在域名解析平台登录成功后，可以添加或选择自己的域名来配置域名解析。点击“添加记录”按钮，创建一个类型为CNAME的域名解析，CNAME类型的解析代表将一个域名解析到另一个域名。然后在博客项目的source路径下添加一个名为CNAME的文件（全大写），并添加自己购买的域名。然后清理后重新生成部署。</p>
<h2 id="2-3-配置主题"><a href="#2-3-配置主题" class="headerlink" title="2.3 配置主题"></a>2.3 配置主题</h2><p>默认为landscape，但还可以自己切换主题， 这里选择简洁的Next主题。<br>地址：<a href="https://github.com/theme-next/hexo-theme-next">https://github.com/theme-next/hexo-theme-next</a><br>进入博客站点路径，</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd blog</span><br><span class="line">git clone git@github.com:theme-next&#x2F;hexo-theme-next.git themes&#x2F;next</span><br></pre></td></tr></table></figure>
<p>然后可以切换使用next主题：在站点配置文件_config.yml中找到theme字段，修改值为next</p>
<h1 id="3-博客美化-amp-添加功能"><a href="#3-博客美化-amp-添加功能" class="headerlink" title="3. 博客美化&amp;添加功能"></a>3. 博客美化&amp;添加功能</h1><h2 id="3-1-为博客添加背景图片"><a href="#3-1-为博客添加背景图片" class="headerlink" title="3.1 为博客添加背景图片"></a>3.1 为博客添加背景图片</h2><p>这也是一个坑的地方。后来参考了网上的做法：<br>找到主题配置文件_config.yml中的custom_file_path关键字。将  style: source/_data/styles.styl这一行注释取消。接着去这个路径下（这个路径为hexo-site/source/_data/，而非主题路径）新建styles.styl文件，并自定义样式：(注意背景图片也是放置在hexo-site/source/images/路径下)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; Custom styles.</span><br><span class="line">&#x2F;&#x2F; 整体背景设置</span><br><span class="line">body &#123;</span><br><span class="line"> 	background:url(&#x2F;images&#x2F;background.jpg);&#x2F;&#x2F; 设定背景图片,images同处于source文件夹下</span><br><span class="line"> 	background-repeat: no-repeat;&#x2F;&#x2F; 设定背景图片非重复填充</span><br><span class="line">    	background-attachment:fixed;&#x2F;&#x2F; 设置背景图片不随页面滚动</span><br><span class="line">    	background-position:50% 50%;&#x2F;&#x2F; 设置背景图片位置</span><br><span class="line">	background-size: 100% 100%&#x2F;&#x2F; 设置保持图像的纵横比并将图像缩放成将完全覆盖背景定位区域的最小大小</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 修改主体透明度</span><br><span class="line">.main-inner&#123;</span><br><span class="line">    &#x2F;&#x2F;background: #fff;</span><br><span class="line">    opacity: 0.85;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 主页文章添加阴影效果</span><br><span class="line">.post &#123; </span><br><span class="line">	margin-top: 60px; </span><br><span class="line">	margin-bottom: 60px; </span><br><span class="line">	padding: 25px; </span><br><span class="line">	-webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5); </span><br><span class="line">	-moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 页面头样式属性</span><br><span class="line">.header-inner &#123;</span><br><span class="line">  &#x2F;&#x2F; 也可以同时定义背景色</span><br><span class="line">  &#x2F;&#x2F; background: #ddd </span><br><span class="line">  &#x2F;&#x2F; 透明度</span><br><span class="line">  &#x2F;&#x2F; opacity: 0.8;</span><br><span class="line">	border-radius: 10px 10px 10px 10px; &#x2F;&#x2F;菜单栏椭圆化 </span><br><span class="line">	box-shadow: rgba(0,0,0,0.1) 0px 15px 35px 0px, rgba(0,0,0,0.31) 6px 6px 10px 0px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; sidebar侧边工具栏样式属性</span><br><span class="line">.sidebar&#123;</span><br><span class="line">    &#x2F;&#x2F; 动画过渡时间</span><br><span class="line">	transition-duration: 0.4s;</span><br><span class="line">    &#x2F;&#x2F; 透明度</span><br><span class="line">	&#x2F;&#x2F;opacity: 0.8</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 标题样式</span><br><span class="line">.posts-expand .post-title-link &#123;</span><br><span class="line">	&#x2F;&#x2F; 设置字体颜色</span><br><span class="line">	color: #222;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 文章版块样式</span><br><span class="line">.post-block &#123;</span><br><span class="line">    &#x2F;&#x2F;background: var(--content-bg-color);</span><br><span class="line">	background: #FFFFFF</span><br><span class="line">	border-radius: initial;</span><br><span class="line">	box-shadow: 0 2px 2px 0 rgba(0,0,0,0.12), 0 3px 1px -2px rgba(0,0,0,0.06), 0 1px 5px 0 rgba(0,0,0,0.12);</span><br><span class="line">	padding: 40px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="3-2-添加评论功能-gitalk"><a href="#3-2-添加评论功能-gitalk" class="headerlink" title="3.2 添加评论功能-gitalk"></a>3.2 添加评论功能-gitalk</h2><p>hexo可以接入很多评论系统，我这里选择了gitalk。<br>首先要在GitHub新建一个OAuth App，在GitHub个人头像-settings-Developer settings-OAuth Apps-New OAuth App中。</p>
<img src="/2021/03/10/hexo-blog-deploy/OAuth.jpg" class="" title="新建OAuth App">


<h2 id="3-3-添加阅读字数统计和时长"><a href="#3-3-添加阅读字数统计和时长" class="headerlink" title="3.3 添加阅读字数统计和时长"></a>3.3 添加阅读字数统计和时长</h2><p>这里有一个大坑，就是和next主题版本有关系，我这个版本发现这个主题本身配置文件中并没有hexo-wordcount，而是symbols_count_time，这个需要安装hexo-word-counter这个插件：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-word-counter</span><br></pre></td></tr></table></figure>
<p>next主题本身的配置中就包含了：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Post wordcount display settings</span><br><span class="line"># Dependencies: https:&#x2F;&#x2F;github.com&#x2F;theme-next&#x2F;hexo-symbols-count-time</span><br><span class="line">symbols_count_time:</span><br><span class="line">  separated_meta: true</span><br><span class="line">  item_text_post: true</span><br><span class="line">  item_text_total: false</span><br></pre></td></tr></table></figure>
<h2 id="3-4-为文章末尾添加文末结束标志"><a href="#3-4-为文章末尾添加文末结束标志" class="headerlink" title="3.4 为文章末尾添加文末结束标志"></a>3.4 为文章末尾添加文末结束标志</h2><p>themes\next\layout_macro\路径下新建布局模板文件 post-end-tag.swig，添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &#123;% if not is_index %&#125;</span><br><span class="line">    &lt;div style&#x3D;&quot;text-align:center;color:#bfbfbf;font-size:16px;&quot;&gt;</span><br><span class="line">      &lt;span&gt;-------- 本文结束 &lt;&#x2F;span&gt;</span><br><span class="line">      &lt;i class&#x3D;&quot;fa fa-&#123;&#123; config.post_end_tag.icon &#125;&#125;&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">      &lt;span&gt; 感谢阅读 --------&lt;&#x2F;span&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br></pre></td></tr></table></figure>
<p>在文章布局模板themes\next\layout_macro\post.swig中添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;#####################&#125;</span><br><span class="line">&#123;### END POST BODY ###&#125;</span><br><span class="line">&#123;#####################&#125;</span><br><span class="line"></span><br><span class="line">+ &#123;% if config.post_end_tag.enabled and not is_index %&#125;</span><br><span class="line">+   &lt;div&gt;</span><br><span class="line">+     &#123;% include &#39;post-end-tag.swig&#39; %&#125;</span><br><span class="line">+   &lt;&#x2F;div&gt;</span><br><span class="line">+ &#123;% endif %&#125;</span><br></pre></td></tr></table></figure>
<p>在站点配置文件_config.yml末尾添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">post_end_tag:</span><br><span class="line">  enabled: true  # 是否开启文末的本文结束标记</span><br><span class="line">  icon: paw # 结束标记之间的图标</span><br></pre></td></tr></table></figure>

<h2 id="3-5-调整首页文章间的间距"><a href="#3-5-调整首页文章间的间距" class="headerlink" title="3.5 调整首页文章间的间距"></a>3.5 调整首页文章间的间距</h2><p>默认的主题中首页文章间的间距太宽了不是很美观。因为我选择的是Next主题的Mist Scheme，所以在hexo-site/themes/next/source/css/_schemes/Mist/_posts-expanded.styl中，修改如下参数：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.post-block:not(:first-child) &#123;</span><br><span class="line">  margin-top: 30px; &#x2F;&#x2F;调整文章与文章间的间距，这里默认是120px，太大了</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-6-修改文章内链接文本样式"><a href="#3-6-修改文章内链接文本样式" class="headerlink" title="3.6 修改文章内链接文本样式"></a>3.6 修改文章内链接文本样式</h2><p>在 site/source/_data 目录下新建 styles.styl 文件，填入下面内容。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 修改链接样式</span><br><span class="line">.post-body p a&#123;</span><br><span class="line">  color: #0593d3;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    color: #ff106c;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a, span.exturl &#123;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    color: #ff106c;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>主题配置文件_config.yml 去除 styles.styl 的注释。<br><code>style: source/_data/styles.styl</code></p>
<h1 id="4-可以开始你的写作了"><a href="#4-可以开始你的写作了" class="headerlink" title="4. 可以开始你的写作了"></a>4. 可以开始你的写作了</h1><p>Hexo支持markdown语法，可以参考官网<a href="https://hexo.io/zh-cn/docs/writing.html">https://hexo.io/zh-cn/docs/writing.html</a>。首页放置的是所有文章，在写文章的时候自行放置<code>&lt;!-- more --&gt;</code>指令，代表从这里省略了后文，会在此处出现一个阅读全文的链接。</p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2021/03/12/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<span id="more"></span>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
</search>
